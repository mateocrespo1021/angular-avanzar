<!-- <button class="btn mx-2 mt-15" mat-raised-button (click)="redirectToHome()">
    <mat-icon [svgIcon]="'heroicons_outline:home'"></mat-icon>
</button> -->
<div class="flex flex-col items-center justify-center w-full h-full">


    <nav class="sticky  w-full z-20 top-0 left-0 bg-white">
        <div class="max-w-screen-xl flex flex-wrap  justify-between mx-auto p-4">
            <a href="/home" class="flex items-center">
                <img src="../../../../assets/images/logo/avanzar.png" class="h-8 mr-3 " alt="Flowbite Logo">
                <span class="self-center text-2xl font-semibold whitespace-nowrap text-black ">EvaMarket</span>
            </a>

            <!-- <a href="#" class="flex items-center mt-4 ">
                <span class="self-center text-1xl  whitespace-nowrap text-black">Producto</span>
            </a>

            <a href="#" class="flex items-center mt-4">
                <span class="self-center text-1xl  whitespace-nowrap text-black">Servicio</span>
            </a> -->

            

            <!-- <div class="flex-auto">
                <mat-form-field
                    class="fuse-mat-dense fuse-mat-rounded w-70 min-w-50 mt-8 mr-30 ml-30"
                    subscriptSizing="dynamic">
                    <mat-icon
                        class="icon-size-5"
                        matPrefix
                        [svgIcon]="'heroicons_solid:magnifying-glass'"></mat-icon>
                    <input
                        matInput
                        
                        [autocomplete]="'off'"
                        [placeholder]="'Search contacts'">
                </mat-form-field>
            </div> -->

            
            <div class="flex md:order-2  items-center ">
                <mat-form-field class="fuse-mat-dense fuse-mat-rounded min-w-100 mt-4 mr-10">
                    <mat-icon class="icon-size-5" matPrefix [svgIcon]="'heroicons_solid:magnifying-glass'"></mat-icon>
                    <input matInput [autocomplete]="'off'" [placeholder]="'Buscar Publicación...'" [(ngModel)]="textoBusqueda"
                        (click)="mostrarHistorial = true" (keyup.enter)="buscarPublicaciones(textoBusqueda)" (keyup.enter)="historialBusqueda()">
                    <!-- <button class="btn" (click)="historialBusqueda()" (click)="buscarPublicaciones(textoBusqueda)"  (click)="mostrarHistorial = false">Buscar</button> -->
                    </mat-form-field>
                <a mat-flat-button [color]="'primary'" [routerLink]="'/sign-in'" style="margin-right:5px;">
                    <span>Iniciar Sesión</span>
                    <!-- <mat-icon class="ml-2 icon-size-5" [svgIcon]="'heroicons_mini:arrow-long-right'"></mat-icon> -->
                </a>
                <a  mat-flat-button [color]="'primary'" [routerLink]="'/sign-up'">
                    <span>Registrarse</span>
                </a>
            </div>
        </div>
    </nav>

 
    <div class="relative flex-0 py-8 px-4 sm:p-16 overflow-hidden bg-gray-900 dark w-full h-100" style="background-image: url('../../../../assets/images/logo/tienda3.png'); background-size: cover; position: relative;">


            <!-- @formatter:on -->
            <div class="z-10 relative flex flex-col items-center">
                <h2 class="text-xl font-semibold">{{systemName}}</h2>
                <div class="mt-1 text-2xl sm:text-7xl font-extrabold tracking-tight leading-tight text-center">
                    Productos y Servicios .
                </div>
                <div class="max-w-2xl mt-6 sm:text-2xl text-center tracking-tight text-white">
                    Cada elección que hagas aquí ayuda a respaldar la importante labor de {{systemName}} en su búsqueda de un mundo mejor.
                </div>
            </div>
            <div class="button-row ">
                <button class="btn mx-2 mt-4 " [color]="'primary'" mat-raised-button (click)="buscartodo()">
                    Todos
                </button>
                <button class="btn mx-2 mt-4 "  [color]="'primary'" mat-raised-button (click)="buscarGastronomia()">
                    Gastronomía
                </button>
                <button class="btn mx-2 mt-4  "  [color]="'primary'" mat-raised-button (click)="buscarProductos()">
                    Productos
                </button> 
                <button class="btn mx-2 mt-4 "  [color]="'primary'" mat-raised-button (click)="buscarServicios()">
                    Servicios
                </button>
            </div>
            
        </div>

        
      
    <!-- Datos sobre la fundacion -->
    
    
 <div class="container-fundation">
    
        <div class="container-conten">
            <div class="container-fundation-info">
                <!-- <div class="flex flex-col items-center px-6 py-10 sm:px-16 sm:pt-18 sm:pb-20 bg-white dark:bg-gray-800" (mouseleave)="cerrarHistorial()"> -->
             <div> 


                
                
                

                <div *ngIf="mostrarHistorial && historial.length > 0" class="historial">
                <h4 style="width: 100%; text-align: center;">Historial de búsqueda:</h4>
                <ul>
                    <li *ngFor="let item of historial">
                    <button mat-button class="custombtn" (click)="buscarPublicaciones(item)" (click)="seleccionarTermino(item)">{{ item }} </button>  
                    <button style="margin-right: 10px;" mat-button (click)="eliminarTermino(item)">X</button>
                    </li>
                </ul>
                </div>
              </div>
                
                <!-- <div class="button-row">
                    <button class="btn mx-2 mt-15" mat-raised-button (click)="buscartodo()">
                        All (Publications)
                    </button>
                    <button class="btn mx-2 mt-15" mat-raised-button (click)="buscarGastronomia()">
                        Gastronomía
                    </button>
                    <button class="btn mx-2 mt-15" mat-raised-button (click)="buscarProductos()">
                        Productos
                    </button>
                    <button class="btn mx-2 mt-15" mat-raised-button (click)="buscarServicios()">
                        Servicios
                    </button>
                </div> -->
                </div>

        <br>
        

        <div class="flex-auto p-6 sm:p-10 mat-20">
            <ng-container *ngIf="publicaciones$ | async as publicaciones">
                <ng-container *ngIf="publicaciones.length > 0; else noPublicaciones">
                    <div class="grid grid-cols-1 sm:grid-cols-3 gap-6">
                        <ng-container
                            *ngFor="let publicacion of publicacionesFiltradas.slice(0, 12) | paginate: { itemsPerPage: 12, currentPage: page }; let i = index; trackBy: trackByFn">

                            <fuse-card class="flex flex-col max-w-80 w-full filter-listing">
                                <ng-container *ngIf="
                publicacion.productos;
                else servicioMiniatura
            ">
                                    <img class="w-full h-36 object-cover" *ngIf="
                    publicacion.productos
                        .miniaturaProducto
                " [src]="

                    publicacion.productos
                        .miniaturaProducto
                " alt="Card cover image" />
                                </ng-container>
                                <ng-template #servicioMiniatura>
                                    <img class="w-full h-36 object-cover" *ngIf="
                    publicacion.servicios
                        .miniaturaServicio
                " [src]="
                    publicacion.servicios
                        .miniaturaServicio
                " alt="Card cover image" />
                                </ng-template>
                                <div class="m-8 mb-4">
                                    <div class="flex justify-between">
                                        <div class="flex flex-col">
                                            <div class="text-secondary text-md"> {{
                                                publicacion.tituloPublicacion }}</div>
                                            <div class="text-2xl font-semibold leading-tight mt-1">
                                                <div class="flex items-baseline">
                                                    <div class="text-2xl font-semibold mt-2">
                                                        <ng-container
                                                            *ngIf="publicacion.productos || publicacion.servicios; else precioNoDisponible">
                                                            <ng-container *ngIf="publicacion.productos">
                                                                <ng-container
                                                                    *ngIf="publicacion.productos.precioInicialProducto && publicacion.productos.precioFinalProducto">
                                                                    <div
                                                                        class="text-2xl font-semibold leading-tight mt-1">
                                                                        Desde USD ${{
                                                                        publicacion.productos.precioInicialProducto
                                                                        }}
                                                                    </div>
                                                                    <hr class="price-divider">
                                                                    <div
                                                                        class="text-2xl font-semibold leading-tight mt-1">
                                                                        Hasta USD ${{
                                                                        publicacion.productos.precioFinalProducto
                                                                        }}
                                                                    </div>
                                                                </ng-container>
                                                                <ng-container
                                                                    *ngIf="!publicacion.productos.precioInicialProducto && !publicacion.productos.precioFinalProducto">
                                                                    <div
                                                                        class="text-2xl font-semibold leading-tight mt-1">
                                                                        USD ${{
                                                                        publicacion.productos.precioFijoProducto
                                                                        }}
                                                                    </div>
                                                                </ng-container>
                                                            </ng-container>
                                                            <ng-container *ngIf="publicacion.servicios">
                                                                <ng-container
                                                                    *ngIf="publicacion.servicios.precioInicialServicio && publicacion.servicios.precioFinalServicio">
                                                                    <div
                                                                        class="text-2xl font-semibold leading-tight mt-1">
                                                                        Desde USD ${{
                                                                        publicacion.servicios.precioInicialServicio
                                                                        }}
                                                                    </div>
                                                                    <hr class="price-divider">
                                                                    <div
                                                                        class="text-2xl font-semibold leading-tight mt-1">
                                                                        Hasta USD ${{
                                                                        publicacion.servicios.precioFinalServicio
                                                                        }}
                                                                    </div>
                                                                </ng-container>
                                                                <ng-container
                                                                    *ngIf="!publicacion.servicios.precioInicialServicio && !publicacion.servicios.precioFinalServicio">
                                                                    <div
                                                                        class="text-2xl font-semibold leading-tight mt-1">
                                                                        USD ${{
                                                                        publicacion.servicios.precioFijoServicio
                                                                        || "Precio no disponible" }}
                                                                    </div>
                                                                </ng-container>
                                                            </ng-container>
                                                        </ng-container>
                                                        <ng-template #precioNoDisponible>
                                                            Precio no disponible
                                                        </ng-template>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <button class="-mt-2 -mr-2" mat-icon-button>
                                            <mat-icon class="text-red-500 icon-size-5"
                                                [svgIcon]="'heroicons_solid:heart'"></mat-icon>
                                        </button>
                                    </div>
                                    <div class="text-secondary text-md mt-1">

                                        <ng-container *ngIf="
                                publicacion.productos;
                                else servicioDescripcion
                            ">
                                            {{
                                            publicacion.productos
                                            .descripcionProducto
                                            }}
                                        </ng-container>
                                        <ng-template #servicioDescripcion>
                                            {{
                                            publicacion.servicios
                                            .descripcionServicio ||
                                            "Descripción no disponible"
                                            }}
                                        </ng-template>
                                    </div>
                                    <div class="mt-3 -mx-3">


                                        <button class="px-3" mat-button [color]="'primary'"
                                            (click)="openComposeDialog()">
                                            <span class="mr-1">Detalles</span>
                                            <mat-icon
                                                class="icon-size-5 transition-transform ease-in-out duration-150 rotate-0"
                                                [svgIcon]="
                                    'heroicons_mini:chevron-down'
                                "></mat-icon>
                                        </button>

                                    </div>
                                </div>
                            </fuse-card>
                        </ng-container>
                    </div>
                    <div class="text-2xl  tracking-tight leading-tight text-center mt-20" >
                        <pagination-controls (pageChange)="page = $event"  previousLabel="Anterior" nextLabel="Despues" ></pagination-controls>

                    </div>
                </ng-container>
            </ng-container>

            <ng-template #noPublicaciones>
                <div class="p-8 sm:p-16 border-t text-4xl font-semibold tracking-tight text-center">No hay
                    publicaciones
                    disponibles!</div>
            </ng-template>
                        <div class="text-center mt-32">
                            <mat-icon class="icon-size-5 transition-transform ease-in-out duration-150 rotate-0"
                                [color]="'primary'" [svgIcon]="
                                                'heroicons_mini:chevron-double-down'
                                            "></mat-icon>
                            <p class="text-gray-500 mt-2">Ver más recomendaciones de productos y servicios
                                personalizados</p>
                            <a class="mt-2" mat-flat-button [color]="'primary'" [routerLink]="'/sign-in'"
                                style="margin-right:5px;">
                                <span>Identifícate</span>
                            </a>

                            <p class="text-gray-500 mt-2">¿Eres un cliente nuevo? <a [routerLink]="'/sign-up'"
                                    class="text-primary">Empieza aqui</a></p>

                        </div>
                    </div>
                </div>
            </div> 
